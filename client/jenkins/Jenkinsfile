pipeline {
    agent {
        docker {
            image 'node:lts-buster-slim'
            args '-p 3000:3001 -u root'
        }
    }
    stages {
        stage('Install Dependencies for FE and BE') {
            steps {
                            sh "cd client && npm install"
                            sh "cd server && npm install"
                        }
        }
        stage('Deploy FE') {
             steps {
                            sh '''
                                apt-get install curl
                                curl https://cli-assets.heroku.com/install.sh | sh;
                                heroku container:login
                                heroku git:remote -a w2w-front
                                git subtree push --prefix client/ heroku main
                            '''
                }
        }
    }
}
